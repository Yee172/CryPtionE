# A certain type of tile comes in three different sizes -
# 1 × 1, 1 × 2, and 1 × 3 - and in four different colours:
# blue, green, red and yellow. There is an unlimited
# number of tiles available in each combination of size
# and colour.
# These are used to tile a 2 × n rectangle, where n is a
# positive integer, subject to the following conditions:
#    The rectangle must be fully covered by non-overlapping tiles.
#    It is not permitted for four tiles to have their corners meeting at a single point.
#    Adjacent tiles must be of different colours.
# Let F(n) be the number of ways the 2 × n rectangle can
# be tiled subject to these rules. Where reflecting
# horizontally or vertically would give a different
# tiling, these tilings are to be counted separately.
# Find F(10^{16}) mod 1000004321.
# ----------------------------------------------------
# Analysis: matrix multiplication

a2dfd313e3819aa7d6f7efaa778c8f7cee591715f596039ca05ebccd0290a5a2fe5c10675c6508b992f39716759a633100f8
43cea5a2c9b3a97263981240fb221c4d61a24edc731edcb92d2f47f4556ecc420451d270cf94ef6fbed5f0c04a1dd685d12d
656c27a64e3d578a4c91eb80bc6c9fd7b32acc86487d25ae70888cbcd52ba43d999cd00d80613ef6810060f2e419c48447f4
00d9aa63ed974e5954bb4730702a41e51d9a77aabbd3d7a375b16e016b21baa199dc0faabf2f550d4a11370831c5b1f3fc64
fa6f71b35657d03fe0f5edf3c7c0421b84bfa5e2dcd5c0cdcd24d7af2f6eda0202c1508d481f9ce78949fabcd4cc7039ef00
0fe9ce823cdb7c2d2d7c9660bd7dced3f7d7f3c5c5cd5396ddcd25ee212c0674599c4bc68b06ef3dde3bd252b3dc7697cab7
590fd8d859d576c8f82c7d716d2d50055add8d0d78b53c7bca2f558dcd31460d61860b6a04aafaa8a1fd789fbae0d46b5b7e
a8d84c86f5548325a43f2849d4d87c43b12732c4216a13e892b45c9a160b2239dec5a332d8fb171e41572d87b3f881d9756b
7f508ff69f23513e07803bb10466c7f6489cff4d814eb551ac8f15ca5ba9e0e3bd90b7d1e69e8d90770b4bc6a7a135b0c807
59ffb934c6fa4db1e8f428923521734329cbfab11114a77409af94acb1a230934a4e9074567f76e5608ba83eaac29464b8d2
11dc3011fc3bbaf8e921316b3de11e877c2d2d7c70c7d262db1b8547d65759b01475647ed64dabe7396e952a89891695cb4d
c239eec1bf6bff2763d453f60c17bafda920454237f30b24e10b461463d0898b75e1a01d7a4187f309296fbe9c9a2000944f
0a08f76d7af5a832d6cb37e269df883b10233d4916fc002734729ebad08f75e36ad36a54bbfb9b9d35bcc8e55fdfcdc2102f
8fd1fb02a937d297e5e3c965c1cac5cdae0c6236628845d0c5793c098e11f2755db28098b2b422d6b64f3ee4713fa33db101
03c2b70d60908e7115f27157259a80b12e6bde494c5a443899d6a39b738fa2c622fd13949d88fc2d83440cc6624cce0f2c89
50fcded2c1795bf068c7cc42535599fbae578a710a2e4c6ddcd07c2d2d7c52de9e845c4e3f354cbfdd3908631c3e65a5b335
559874c32ba631bbdca518fa8e0c314df44efa5ab8424c18203d11842db5ba59f4bde59c0097e4c81a12297ed57d9b6bd8fa
9367c9e705ab4bb8bc98c17a24dfb48263daf3fb2d7228d2ec64cad4f8da6e736488076ab72b25d027553c6074ba13ce185a
a631d068e18124a9f5bbd51478f8d5ac19948e24c00f34ac4e79aaeb3d05edec2de35d5b273883b99cd18b2a4c21e1808581
e7d254a932b150983ae906a819ce837f1d9120bcb3ef1df0cf5ca5c51a6c7601a1426faeeca8d6af06804cda4ea501bb7fa0
dbb2046d531438c110e4b195cfb1e022dc493e1302c88c002103e6dff1130cfea215fa947c2d2d7cbe8441ca6e326ae10139
dfdf522d65fbb2a8309235578313edb7bb2cc52504052c31ddcfe8624da1e0cdea58aaa2f303094d0bf59e138677d134d1e7
774eba63d23cbb8295e85418eb382fb0f14e939a5db5344af93c57e1c9002584129cab8a62ddb90423e5f1ce1070e938f3b9
8e78f09c6314d6658391d2ac703cbbbd8e45467ee72c36ed819c76788e64b32778a8ca8e0c627eb544db03012838874f6e32
f5f7477c94e86a837549a7de8d97e0a6b5c9673c04dc7f5cd0378fd2dc9da43de8229c4a4ee31f893083b3725b41c3b94b07
5fe898bed5c5646e55b2f8468c5d0038bf960e4d9b30a54c842c54b5ff5a18cbfc94b7248d73f5e98e256f0237e7
