# At Euler University, each of the n students (numbered
# from 1 to n) occupies a bed in the dormitory and uses
# a desk in the classroom.
# Some of the beds are in private rooms which a student
# occupies alone, while the others are in double rooms
# occupied by two students as roommates. Similarly, each
# desk is either a single desk for the sole use of one
# student, or a twin desk at which two students sit
# together as desk partners.
# We represent the bed and desk sharing arrangements each
# by a list of pairs of student numbers. For example,
#    with n = 4, if (2, 3) represents the bed pairing and
#    (1, 3) (2, 4) the desk pairing, then students 2 and 3
#    are roommates while 1 and 4 have single rooms, and
#    students 1 and 3 are desk partners, as are students 2 and 4.
# The new chancellor of the university decides to change
# the organisation of beds and desks:
# he will choose a permutation \sigma of the numbers 1, 2, ..., n
# and each student k will be given both the bed and the
# desk formerly occupied by student number \sigma(k).
# The students agree to this change, under the conditions that:
#    1. Any two students currently sharing a room will still be roommates.
#    2. Any two students currently sharing a desk will still be desk partners.
# The downloadable text files beds.txt and desks.txt
# contain pairings for n = 500. Each pairing is written
# on its own line, with the student numbers of the two
# roommates (or desk partners) separated with a comma.
# With these pairings, find the number of permutations
# that satisfy the students' conditions.
# Give your answer modulo 999999937.
# ----------------------------------------------------
# Analysis: disjoint set union

cc72e74de691003e4a30a9b574165507914105977cbf46b2cb8ab379b687a95e5a86931c862b4f913871eeee735e9ab1e3ed
5b116f5ca6b80ecd9f9a5b91ce3ed67266656499ea05817b878f5e27c5829fb95e7e691ca0feb5bb68e5fa5db9f42f4d8fa6
f20c006ff5211b3513561038cc0f3b63fbfaa285e189920b266a16512d2a831a781db3867c9301d707042199d01539c3faca
ce57488107f807f55007ea0870bf718383af9e6326153f7b4473ffce9c9a1e5b29e94916cac6e5a445ddd5cd8ad90d4998ab
340ff5294580115bb94f4f99184857f95cdf8ae7d677e9b4a986170a4dccfd07b806c48abdfb1bc992a1f43b1c6d97b22505
5d2fa850f2e57c2d2d7c5920c2c6f099ba13d0f9f04d0f3bc877ab218ec5c25f51117ef2df510ef653ac7190b79f9475b7a5
ee7882a94aa735863c846f856fa0e63ac97eed4c7c7a935f9e0bb549e948553b1888267ae1baaf6eb9f8774a484d9f8ae43d
9a5f1b59bf2d5f1b647a98a92437533db03c1cee7b3d5a0ea471daf2eaf5e685578330af362842604eb936028f9f10599c70
41ce5953a790f0393f8593b8a1ccd6ada0f7adcc13179f6b8ea2fd2c1a970d068660f6da148cfb4bf53edd77fab1a577db05
7aab5fc8e7dced572075cbb2ce2def8a8d7eaca06bef141922424306baddb9c48ac9991eb31095be1a03d23b0a585c71d894
1737d64c25d90267c4c93267706553107c2d2d7ccaeaa3b0041194f3e4cf235ff902a189b1f490a46e18a307cb6b7e20e40e
f5dced44f79444ec240a1a53a06d53f067dfcdd2bf710dadb02c0c5d552c2f266935fac078bce37ed84837268eae99ebc902
9b8de73a6ce703e58ac451ce964f77ba216e5b8f3f131b66244b6c9ef939de8b1f5be11b15920a9f8fdbbececf55ba1df42f
262ef50973ab6ba9a5bbe1dbaee31db303c0e08853c507482d2f54ea7a6e504e7a9bc9ecbd172b940fee0efbec76ddc56332
6257d53b313b4bd73d1a7bd505a5e70bdd3dda976baf9364a05598306058af92d4a649acc4b9d0a251d7f7c334a81c300d69
0c5eb1964f69930117fd36345f0dfd5cdd1de94c88e74b8a2e9d7c2d2d7c795bddb2a6f5e0b5d9e11fbfa971d405f453a9db
6698db2e5d6594ff6aa910b9689cfb70ad2943f0749a14ccef0348fc3bd7eeb65809ff2f23afec85ae9164d3c66dbfcafce1
236dc182c45cd0c1b6ba2296acb14d086cc5f1b87433a15e0983a10123b84014cbeb9c47d49f2d3fec8d2b26d4be6cf6fa9a
9a1fa3019d1d2525b54963381658c167c2c94071ae625073b5acbd4cace54a63570cd4a47a5474bc955f4b52c54b5c8f16b7
880cb7714af57a46e12e33be05678d035c1c9e59f781beb955d4a409cf2a8c2aca5cbea1096f8740aa8dd6f76593acaafa8d
ecb428d3bfaaab17eb424f4d7b7b644ccc9553ef4ab0218eb7938d43146d9d974bccbf307c2d2d7c5a654dce1ede79bc2382
52c854a5cabb4cbb7a59685d2b61c84c348aeeafeced9667a94c1aa844e6179f95508b02f83d908805259e307316ddf3a3e3
dcba9c63a34459e51db804b81299c3c63f55106fefb86c4645e854c5dd65d70ae2d2eee2254b95fbc53dba21ad0dfe74ffc4
ebe1926844517ae94ce102a612b6c9faef43948d0ea15d4b6835a9319c5df878eb9bdd88d318d3e0d260dfc2096f2dc17314
ba85c7aecf74aeb40fea49ffae09ac8cae97e2a2e090aaa45f56e7f40c12e510aaa1517705a39c179303e67443616c405b8f
41b0c23e40a7be67ef86dfcc1d8d7018401ffb29ee5b6b77fbce170c648e6d6dc6c9710dc0b47c50f3c6222f5c227c2d2d7c
5ef1e8d725197b40ce0383d1eeb02631180ebcfacc19ab55ec8ce669e8a84bf33518e890938b9a111253d3818e44095c03ce
2010c14bf900f8a142faecfcca32be34aec596ed6ce41ff6defdc1d6553ad1cdcf80724374791f2e5f904a0c8b54a5094682
7ef8d129c7ad72d89a7a2594d606a3c524698c22a645bbccb2fb0ade66737e29dde71b3bd5f91ef0d0b6ccc5834f097a1281
ad5f88ecca673cb65a23b7313ef756537a915d1ae1be4c37852c4665d4ed9b13aa72cc6ce74c57068a5bab40a372c2b011c1
ee82d9709f5c9e8f6904665b521cc2a75d1580b3ac1242b6304e9b718fed7e4db1f1c4d1a5b0daf1796baa393aa841d53400
6e4a5296bb0e7c2d2d7c4595bc2d731b33fc0e2de40bcbb6ed833c339153955b89769d2dd8226d9e99169a4952ce2319e60a
2bba7bad7e767118e43a14d96fd264de31926773b398333d72e529c2fe44e79cf47c705da625767ab4e8f0f7b831c34d5f0a
4e1d60f55639b40135ec02648ad821a7bbfefcc04d869b74adac3d80ff03d615ded139204eac417156883f926ad3b357131c
0ef1ae5165a8b5744ec94fa6f34398f131597b379e14462a829f711c93002a585d9139e91303f8eabc6f390243cb56f469d2
4de38a1b270ca361701161192760c052eae1a8879880431e1603a5161983a1cedb998264444e024fa02f2f16c3af829c7fbd
d96c49090346af8f868b21e68461d8a67c2d2d7c4b24f494191593d5cb10b177cfee64db054274f53e49abffbef5901e019e
3fdbf53d53ad5f1bbccacfea389cd19fff45bf24c4e9755eb7d490693bffdfc33db7b525ed21940060409f5c2a13ff1ab58b
c585f24ca91dbcd614210cfdf454272bb37c0ab484a547254e11f115a7ad4eea98f449ee65ffcb189b8dac3fbb3184302d21
1b737ab0aaac47efd2c450c6ab96fb93d4b47427f5492763ad67504e17e255f7eb52d76f196b0b2c90cf2465c1cf92016156
2b0681d47bf61120606e6a06bbe7b49a9af1e54e831bc4a56daff9d7bed95d85d8264f8617a4aadddc96598e0e89ade20563
0de99fc39c151ea93ad4f9c30746dc7f12cc74a5d48db4646835
