# A certain type of tile comes in three different sizes -
# 1 × 1, 1 × 2, and 1 × 3 - and in four different colours:
# blue, green, red and yellow. There is an unlimited
# number of tiles available in each combination of size
# and colour.
# These are used to tile a 2 × n rectangle, where n is a
# positive integer, subject to the following conditions:
#    The rectangle must be fully covered by non-overlapping tiles.
#    It is not permitted for four tiles to have their corners meeting at a single point.
#    Adjacent tiles must be of different colours.
# Let F(n) be the number of ways the 2 × n rectangle can
# be tiled subject to these rules. Where reflecting
# horizontally or vertically would give a different
# tiling, these tilings are to be counted separately.
# Find F(10^{16}) mod 1000004321.
# ----------------------------------------------------
# Analysis: matrix multiplication

9ef498e9cadbf72280e74b5ae2b834f8e19f207668da13bbbd10a6807efeafcc685c775f91927b12c0ace3bdb54c16251c7f5ae9dbc7f9f750a981d94e4bf75a759afaf934304c2619db75e1ba400f83378528bceeb086292d7330fbaa5376cbc904b219d2d056268ccdf8e8985e18f842cd47c3edfc2418d55c7d0aeff5e97a78fb2afd44461cb6c6e59e480248aa0988de98899870b59b0c41d196a4df9bda8ab963fd17c1906f87b4fc03784da00ea876dda5fbea65545cf5d616fba82779e4774a13c1d35419f5e62d63f4c520f65964f76089d414944eb09be6a64a31ba5f98bdb5a4db1c20e1cea6de8fbeb81bd29b08736473e1becf5cb3ae33cad0a67c2d2d7ca4bd43fad70b055ccede72e66401bc88cbbf359eff4af598550b05d2e7e114f9dd9256c0db11f03e8a4a9977862265bccb4006e7cf9a60321584f696a7189b44af093e5ed9320bb83260016cb923f5f90151b5f6e122509894a1a0758d7a5d71be7d0fa68492ec2ebe2c6430099386c734df72f37885ea8de4d7ac740280455853708627fe2897c25bb16b7c2c9b8ab93c22501762e5d26b9c4a14396d0fb1173e8a2057d18cf7b9b481b0b4fabfcaddeb3dfca8d37179e199ff2aa97a3a441bfa3eb38a15a0dfa25a925e66c3f62df2629630b5e88f250094701b2f5a22e0934b3ba9e21c05984c87ad7e334e312cc4d6bb67960e6e0e1cc4fd8b2012b4ab877c2d2d7cb299e8d3831b3a9c73f5efa90cec53d144009eee5d24dbf345d9c29bec71898e652258a4c2e542dea1db5d4aa10b6a2c166deacf6a570f05da7fb35ad985495a983e5f6aed8ac4eb1ff068b699572eb15a2a2ff4773af5223aff078a75be95b03564bc9af80b9a577bf7468a799cdc911023052f0044af4470bdc1c9f280a46b42eec11d01a0529bc76965778af4706c1be82a82932a394f1578c94be38e8d627948767d11029a48dfccdf32c75eebb4ad1d67320ab227b31abfdc0d7d92a63708636c09c43688dc2fafc8e14ea9e410eb061c6813a0475db2a55acb89519253ebd65b91552bed986c696a6a494bb346bf32503334453d8d85ead6033022b74b7c2d2d7cc2cf26e9de872dc4208806883547295022985b8d721151ff1ab01d8b0415d2b0b400fb61a40a1a8658961cfd376372e1c7f145047bf01ca188556671dd0f955264e9985e5e98c8ec34de817ca534a6dcf8fbc6ca99f61233853f35d77e646b4946246e5b632bff03eadf4df88a573d675e0368eebd833112065f376ea7f0c852ba9274df329525bbde22a4cc6389eae635540c8f4235572292e90b447197ceea661fe3e0be703597ead4ecb8b15ace18bd6e7938a7929516e45389e642a309945785c71ddae177f7d6fda62b88844fb0871129a45545776a2c734ec095f800741804c4940a4067ea26487c53ecbe42fa345e22e11c9a822a044c0940a39c73197c2d2d7c89acbee3416baa6272549d41b762144038c1c56b6d037403883fa6c188361944bd3bdf4675757b08bf636c8f349dfd7f40fe1ff9f3f61099c54884ff73c51931d93bf8924aa7e2e1639448f7207618c71f75e5d6d81cf33ed5b449e48bcea98a9368ca8e0397aaefd81ea4338d51c9b86e9c013844e601d4b110c5ecb493932177fb13458d27a85d173ee51d6ce6ddaab72dfc870bb8930ec3c7457c6bbe0643a8925c0344a287dcfae71b1092a81b259304e877edda4da8ac4e4e69b7730c72be9bc6663b53d5ee87cf717cbb84e79bef053acdac04d8b01cceaf986e3ead113a47ca92434972e2faf0a7d0fd910aced599751e515a2decdb09b631c990264a
