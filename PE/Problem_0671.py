# A certain type of flexible tile comes in three different
# sizes - 1 × 1, 1 × 2, and 1 × 3 - and in k different
# colours. There is an unlimited number of tiles available
# in each combination of size and colour.
# These are used to tile a closed loop of width 2 and
# length (circumference) n, where n is a positive integer,
# subject to the following conditions:
#    The loop must be fully covered by non-overlapping tiles.
#    It is not permitted for four tiles to have their corners meeting at a single point.
#    Adjacent tiles must be of different colours.
# Let F_{k}(n) be the number of ways the 2 × n loop can
# be tiled subject to these rules when k colours are
# available. (Not all k colours have to be used.) Where
# reflecting horizontally or vertically would give a
# different tiling, these tilings are to be counted separately.
# Find F_{10}(10004003002001) mod 1000004321.
# ----------------------------------------------------
# Analysis: matrix multiplication
#           Hint: loop means that start state equals to its end state

87c6aa82282da766ee0ef7a260a4e709809a8061caa90b6419eb988131b1791e5f5faa32b4d4ab264caf81bd21ad48edc92c
8fc16b3dd16db419a9faccf9308eab4c1cb84bb1c68868d90280b8982fd3d2f25cf755cfab23834edbdfa772e4f09d39e910
79d624fd3607660fe26fa3a379fe8b9e5b768b608fe4d4298d6078e5657c4f70c4b200bdc5d36efb0224bea5a0276cfbd5c6
03081156135b4a7e7384e4c7b2c56e2e27f2e7737e7a8867da72bf18096f56d4b8ecf1770711dd3a860dea10eafbde3da4ad
fb9713e5003ec77484abbd8ca1252cc1890d9ab5e0860563b3d6a25260c28196c9cb3d7a17d2a99ab76c0acc6b92e199a3d9
7d23f15e61137c2d2d7cabe7baf6114dd0ffe11a52ebb3dea38e5990eea6dff3c47410dacf6db8461ddeadc3dfcf2ba888ba
f8883d6c08eb059f8080388d54d0ce0a7d0ab3ecb7b0b2e42c65e108f743be4adc4bb77fcc2f0a2d9f6337c1b8df9db7b9d7
2c5e1edc0e2abe5429d5a5147765c53b7e028a7dae0fac458f230f3ab073fcfadbae35335fa3d9cd2d60949ba8b4b28ca057
57d6a5ca490cd69e414ca076e38ea3bb61331b2b03594fe7c832f5fdef95ee138862dc3820a36e3eb5550aa3320516cbcd84
f4e7a22700140e0301ed933706e76d4e83d9f13efaf3229fc13bbfe626deab7f349ce443d91aa092246ab90b8ff82dc25e48
424e8b2ae45413cab4adcb6de29063357c2d2d7c58d84403f826dce916819ba6a087ff8adef09bfc23e6f5855c1d6a5b0803
df5644c3076607a28f77dd46dda410cf23ea20c8861fe2821d26f60512e3f5559bc7e26312b69ae41c66dd3c3200f39dc197
5ffda574a66246ad0b020fc6ae36b63f2e313b530f5cd7953f0c25aca35c4172ec3f1820a3a02dc28f555fb6a15ae48b40f2
043a399f8e7018d06e8b923a6ee740ea8981de20dd6d3c70983b2adc37fc71bfe71e3e8d2454a316fd46efab00874c550cf5
f2522aa6a62297f59c73e3ae5dbaa8fd31624ce23d1d2dd698a204dd9715e1bca2f25f32439f4d8229ebe5a94147353740dc
2bcc65b4a3a38ece8d75ea3a3c18839d90fae2370eb2f48524fe7c2d2d7c8f27ba1a9e40b4e79da1a8957a2d664b87e12369
0b683616b39b49728f379a7622797dabccfd82ec3ab86bb0339f372f9abf950a68559ec0571dd109af975ad4f953c9afd36f
27f23637e05a951049cddfa60d7b7688e9d7d2065a169fcf54dff63fc4d8a42f02197554b4ddeb1260d4ba69d2219476e595
607ba843fa15af39be9760d5e643825a7b03b01ceef57e2f58ff833721109c372dc6d2e8c9502d5bcece5ede56fb0359cbf5
198a72c7a72f0d1f40bba4811aaf581f5b662d308dedb3d5f0cb82484e9e4f3b188c1b5989412a1e7fc47c0df54f9ac11ba4
19410123732be217aa983744cb605bc98a22f594573183fcaee80274f957e0f0a807b0547c2d2d7c7fa9e7442a3929eb9e5e
62011d621e785fd7d8cb2a06234abc26d9a696841ee6b5352dc47139ff6fea1298a12fe2cb970032e6227e749730f930fcf4
fbd50ff8bb18f75f1a0945c3d2f3ef07f7241695d2e7d9bdfc56c3673d9448b5509b5707ed4e5a836853a4c8146308261a24
14e67d322ee710e792e197ac5bb8fd4d05368727db573d7cf4cc667ac064f056c165d14cf0c8afdbd3635928ddf77c145107
07bc2f6f7b6875b39b4427d786268ae1d9f1bb16737887ff0de56b72b4a5f4bb222f9d06d5712e7caa1ac559a3db3515f072
876590f5ba1949f67173e6280947e1c2cd99a3a2e150ea26a47fd09936440348d280fafdc4012d0a1ab05279c9107c2d2d7c
0c43c149b95e572e60c2762b8907016eb864edf31b0a461b771fa966328dd5732af981a2aa635640a70e2ccd720516b12611
a9499c475d4a0981680013acf7a02134c6b9d5231819e1acf2e16b2772045d257549133a9e08913320e582f1da0d07320f22
b6225f4e3aa8b4632895dbd2c06c8469a7665676ee0a4ff6c0b00b935b82547ced21fb24b3b86e65ac499019330fcc3a53d8
84e2fc92147c1da3d8da54cfcdbfa1e40c317b719c2418e37fd4d4f85eafb81297a38c6bff75b833f617c2de3d7defcc8213
89937015216bfd921a19e6d262634b90d44c19bcad0e62d435a4d127f51be989a3945e68ee4744e2e766cdc28195db6c3f0e
505a6488ba2b7c2d2d7c9b32f5ced5961451f34b16adb94c11f56af2e7b3673545f0e785a6c970566257cc5fa7dacb203ec6
a79bfb9b2a650cd6ba8cae0fd7625b0ca94a150c44230c6f63bef116187ca2fec4048d8d2f91253339cc361860f953004218
75e9b2fe536793164905c571d1679d55c08678f6955fbaab26551831c2fb28408847eca01a9e1b131eafcbb5da799c8a6fa4
8e4dfab1413d99342ef4c85eacdb9cf6bc0c88e31406022f6f7d3ff6424b574fb5628974e6d18d9c2cd6b95026cb2cbdd35e
01b4425f38aa0546889ae5dd8dd52ff2c8095f14f141cabe3e6d138705d97ed293f38ee1b0493cf7dcb51e458dd271fe424c
a95ff160ba4431b9b79f792f8515213d7c2d2d7c93f98de36dfef96f08d77029f0cb1c41d327f82e11932ec982362efe0e20
5c0957015c8c89aafb46f84596639c3965d2b6dafe865120bc59ce2367f1628acc0ee67493e36b42e8138c368b83c09a3c6c
1d1f441d62964fa310cfd703a6070a045a2987d06e205a23fefdb1c882faecca539113e405b9b9618d7e34a007c234b8dcbd
0f3db3ef6103b51176b327095ccf21824c077ee569281d2e64f2584f993dabee7f44643898c075e740fc8a168dff04de315e
e5af673c8a320a0a7844d84c752b8507be14a4cb5df472a69bf7434c7100cc4289650db61b43f981c3c18a370ebc1dfab7dc
e9d42b4eef9ff8396aa006f1b39d642a7ea46326905f6ccb46f07c2d2d7cb7fe5d12ae840343add6a886eb2cac14d283ed96
abd76e8997a13e8a720ac24d005be69e13ed3e1b664c806670f03023e7676d5e22e78860a6196fd770598d91d534a9ff93d4
c548ceaa38cdcad44ce1894e6358c65144ccf2f716b43e859b14ae35d6728c69351309d0e002052e57a2df0069e3aa3979c2
9452c42c457754d7d64b3dad6890b80d9c92e96696271efba5218ca18e8b1e073a79bda727f0b70fe69643497cc2c2c6f099
b1f2132374f90b067035a5d3a035d981270deedff40079f935490b167be86bd6c3d42bed4f21aea8257864a6899e944d7d95
75b1e9ad6a6c5bf0c1492b3298015b9029ecb6e2d214a0237aa40b0de0b68397253dda067c2d2d7cb371a001466c6d84fa83
f471f78930df97cbce8c91ed7a459afe441cd1fb8858ee83f9c5daca05915588d837251215c1f9f6738773ea393ebb82454f
1a34b27dea063f9e2cc976f7bbf29722fa6eec64e17eb8d40dc603fdbfee64143185eb05a6911fb1c9defe484b64841187d2
98615ca703c3b9b7f0de93bece5b2449cdb61f266983f16947bc3d227fbdb32bba9f88c9dc4244bfa3f26151e3805a4e540d
507d68282b762c20f68bc5bebb8569ab6fac4f1d2b6bc0085202d27d35b0dacac31887b0aaabf9301adf40c5d5bf7a1bd927
37bab79ced64ad1478ed212cdde3ffc7258f897c9df9a9b62648188afa991de399802718fe1411c0b704092153227c2d2d7c
2f33327c297b25a5313abfb4f43e6fbf32043f907eb60b00680c25d2909311e0ed045651d45ad998b366b1389e45a9d1c7e8
064f9975c923e3a9063d6722a2b0d286abb4bc275d732a1d8bc19277e0274be042f92ff4b76fc9e01cf6cfae9f00c33cafe8
1506c043032d6a59a9e0adfebcf5614eec82980548561b2c827662f2a6e35554f762be3d9ad4b3a8979caa6503f71b372876
9014d8ebd6cf1f79c34f201a72d5a9215e5eb1784f19e777d2be877d3e16b8ba806ea8bd785cfd4a1eb56c9579aaaf55fff6
15a2718d52aa4e67144c713eb49c88f29d4c885f860ea672d975279a79dfdfa1676223fc99d3d0349429d0a27cb43238d715
3ef0dbd6c9c07c2d2d7cc9a3fb113bedd61f0a5ba3cb28eacb27b54cae79b837edb5849b0e041b2558d75fd838fd78a2a270
e2518191470368e07c0d4cdf51354a1f2510cbb16249c62dcde869be1f8f02bd706bfe1b14a8a656e25257167a2d7fdd537b
d2485d6a1a8c97c0b80715a5ff2880a4bf5536292427abc425e9f4f96af6f29461b37284c78793e681c1ce7d265fc50885f1
224fad6324369f4ec8ca2aab47ba98bbb1cfb3dd8508380be36e025c6303054b50ff7e9a3936dcb9c570faf3a53917edd488
7915b8b7034d31ae9d82783774c1ad136f1a794d2a48f42e1f1d979b7f6adeda92319d3ed372600436fd26646e4414d2bbcc
a0582c5681c00e864d5f45c7b22c44a47c2d2d7caab63ad97e9df6a374f866d840eae63da73927c44c1b7c8802e2b2e387dd
eb0430be5854320837cea1b3cd24bb51c067a2928675d8f0303a733059c0eab784eacbb1abc49b435656bc33c202c24815ed
5b73e99ed8f041fc4de8f3cea38f86661f150a5fc901c123c6293ad8f4b7e4bb8ab8a46be8fd12f158f043728489ccc9360b
db096d3d71309d0d302827113f7cb175cd352ba570c758c094574b4f19c54f8a5c3e88b2d9b88226717af2a056c06bc33ce7
a5c46a073dacf97d0a6e758aa85ae8b1c25d920837307917d2841aa73b8a3afb96b4c07b4ca795c19ecf051fff768da39906
60ab5657e39235236000a637faaf0981f2e5d7028ece66e3fea37c2d2d7c13feaf0a855867507b9a47f3df95dc94b79d2729
75ac9aaed08dee0cacf3d3d85ab07ed9b74f3277f6fb65d545e4a6e56aec5c7dd92918d08199644f8370ba1a8090468ec693
8f674e101fb5f58b763bcd4df211bf7da9e25d85fe7ef1460fbe5391074e5f0c644095528f56fdcc0d1cdd6852132d19e42a
fd546bcf5f19073250bf410037a13957eb33d342e5279b63d88453ba6083033a237095a4f794bd9e78774f9e3c67fbd53bdb
004d8e4a3ffc7f0c6d1db5ad2228eb8c954c2f89e4df93a7ad74d45850a5defb41a64a0921a49bcdc7a0a3127bbf3bd93dd9
6119e64e8f195a1f602a617a0ac7fd5b311cfc627ec99e029fc2d9d00ea1dd5250186bcf
