# A certain type of flexible tile comes in three different
# sizes - 1 × 1, 1 × 2, and 1 × 3 - and in k different
# colours. There is an unlimited number of tiles available
# in each combination of size and colour.
# These are used to tile a closed loop of width 2 and
# length (circumference) n, where n is a positive integer,
# subject to the following conditions:
#    The loop must be fully covered by non-overlapping tiles.
#    It is not permitted for four tiles to have their corners meeting at a single point.
#    Adjacent tiles must be of different colours.
# Let F_{k}(n) be the number of ways the 2 × n loop can
# be tiled subject to these rules when k colours are
# available. (Not all k colours have to be used.) Where
# reflecting horizontally or vertically would give a
# different tiling, these tilings are to be counted separately.
# Find F_{10}(10004003002001) mod 1000004321.
# ----------------------------------------------------
# Analysis: matrix multiplication
#           Hint: loop means that start state equals to its end state

27ae08bcd7d4c6bffa188a254130e928099b0258270099a374d0be0fed7f1da6643930114506135481f070af3e81735060ebb39d97c0f1ca613a9d06164d54f321a043d2bf300992ce46e0013091c5bfb5666fe8194664b79e27ea86660c0da09b0773fa9d4c399ac65491412b09ebfc55f55c9f64074102cffd6e29a3de10859250849f73a05cfd2835cefea7acda384a0425045df39401411a8c906c2f187217fd4108362ba1eb60a558270bf19396fd4b1c7e008db40e8760bd5c463fa1109fa23e499d6d9ab378689676761d08f7866c2e77ef01551b56712c929e495080f8327798091a4364282187ba0694d4f0aa4a894032c50b0cf633bd21e8dbe4837c2d2d7c996caf5a86b37d1e26481814931c6bc627fdb541174a7fc9a88716a0c06c67064e54fc45b3edbd14dd1dc3f205b78c534fb4114db5720fe63c3373c8d83da9e835e6b2153d27c9bc9e1310dd7521aa4aa35a0522dd3ef1bb1534e1a84ab2a5f12ffd1e69f77f7a574bb373d014a022b1000c420c15c564476387b34679e81c90ecf3ef02316b85c622b7dcdb2699be151cc50ce5d375b9ed81fa727c401eeb9e80adf4e891e36a86cda886f5a449454e58a123cdc377cebb57e005314c88ecadd80330848a10f65275fe245c0df979356e006b38a16b3bfd02a9b03b5f59049dbdd096edbdac14cd5194bbbd191f61409b1505c6415a9582b1dea162f3f711b27c2d2d7caa3dbcaba73fd654aa67daa4a9c9d0dc0d6bb51888957c7f25e452fe7f01c224e9c7e4752d87b941c7b579f0ebd523042879b3aaad5a2a67d16e606555f2f2587db29d728ab52cdc7184a8f466e21f583a994f7457f1914dcf494e695916fba9cdc9b9aefa3eaf48a022c3ec1ae0659efa2a31f71be278140248686e0b3924815381b36117a6ad5500c9fef763bc63a1549775deebff0af6f936c4cafebdd21cf53b2a6bc3ae7c571a05f0cae2cc9553d37eaccc84e64002416420897e9e1477a8ea7ecbe4579b9de5ee87f80048e8274ba7e1c7429854492f73c96e5c604bc5fb69fb658e3c28fa6dffca449e61f10b77e970b58ad0fcba0c2747d9e5b47fcb7c2d2d7c60c6093b9e59a56af2292a4c5cb79d9640fbd9a47b8631eaf6283eb2d3d037a900ddb3a9c7a303025e6742f48e9d4988ee6949274fd095dfc24a2ab2ed5cde4f3831d319c324ef3be82df630c32908ff5b0d9d33003154eb1ed7efebcc9b0d85f84ac28202a72b50d63d1ccd2ca04ac41d31285646bea6919b5d805221bfc0c29e450a2f1570fed0b94928313d7c173f3f43dac32aa3c28b6b9973dd086bf201d1a9a87a1289e62924a9b25c160a2e9fd11481433b0a055feca51575c9018987453b24749360ad746c8e861a1bd72752e3faba57fbcfc8e37a92833ed49e15f17f7e686d70df5fbaf669a164f2b3c5e3fecbcd334a82233106e46d5acf2cd3d77c2d2d7c3431e6cf1496fa4306f3b112a7e407f97f59491b27ed24d7d2308a72f219556b53b45e24d0870e8d210dfa757682f312719db68827d65ea675845aefac9e4622cf8f50754b22854dbcc65a60515eb04c221b297c2142906f55f5b995fe54a30b1321241676cc445c14dd19904cd48d05f96ca4df0b975b6618b6af8a1397a788580b9722c5a52ec7f6603e6dd6bb42eacc44e3e01560b347c41919f05524bfd4a661fcb1879a9173cd0aeaeb4b327c0d44cb7fc68f88cc1abc3d363b7a797bb53a8db81b1391806a777add50ff8325469e4d9580a61ee4d33b261cb5e9deb0c48058d60c3882fc214d06b3d0feb643d51ddff7b1a18c21f86ec6d9425020cdf07c2d2d7c46ae0080f1e93645f2202abe20f4826e067be0dba5379a4fa7c78273c186e7d64c58f41af90ca94eb15f7f4c802b26387cb997243d7b97c63a3757ae686a77fca9b7bb4e1137da9e54fd57b4516c3fcb1cdb767fb590120e6982d5c40483f58e7263812ad7c855c17196007ff018db482c9d65efcbd64a5d23f7e026b3ca76145f8345d25b493656ffe2a34e14aa16eb6f2fa974001817aa2a390a471082330f5fc3ef904733b2f9713d58811c2e8b83b78756cade3457b1b884642e08725c1e5416d52f8508a73e5af53956e4455fb122b533ea099e1aa01ef236ece84d96f714071dd42048eede35895228663d8313be7f7cbb8d3cf8299c5d803d891db1377c2d2d7c1a23d0b5d35d0f62b179187ae9550252c5da4d91300fddc09bcb298fd2a13a0481b6c43e85d9ef3761789b33ba41973518bf2639df16948f3600b73bc1250af40dbcac937e55dad9ceedf55d7cf34a47720c2fb336e0cda4dff591a301cb47b631d68ca49da80c488149b752afa91684540c83068aa65a642d5677642110783866657c00e50e299cc26e7e8cd11239304bd722fd68a70bc2e712a85b7a89713b798b41f5bacd58a9be65de295ed355963238c746f8beddb3890574097c4090763941983cdb80e09ca13375fa4decb4be1e8a46eeac6f4a82f7880a883fad71634229ba841b5401f71b0df5607771240156c4047226e126e30de3403f82e3402f7c2d2d7c8cdf009e210b6ba25a8f5bb151f6456defbb6e09671ad44d4f4eb41e8b09b2a6938fe405d25549a535beeb796a356e2e416801947a593d36d416bdb4d681a8c1e1b151bf3c3e04aaff1c1496229048465e04119810e904dce7c66df5197d08e182656ed60364d565a3ce37300191555f08e9e1bd64dac35a0558a6966535a5b6e52c6cf8225bc602290b60300c600e43191db01f1f10d4894e3efa8f927ddd2c4967e07086ae419eec8852673e9484aa6628c9cfbdbd003f0a1598514e0e1ebec8866441028a8e94c1608dc9fa857be720e2c1a30e6fa4448ed414e307fceb1989b644771314964736ab2834a2a21233d7c7bbf0ca2b6ff9dc16d6bf59c591697c2d2d7c36d16f95861fd22ea543e158537029596b9a03215bcfb9a32bd3ed4b595d84fd9a6b62da30d04a9441fa1cf2d691094f05860508809ecae46d596c6739757861f736f8c99ed9d7f8632471fd0cb6b5aeb8750169d590bcfb81af6ba37c2419b49c017b744f7109f6b14e3ecc49e399fdbc5362fbaafbbef65b26a3484c5b720f49fcb91e1adb081acb105ae96f1e9e7f239e2dab39e2b3cf025f46e38da190c38293da43d9660b5880eb36f4ba888333db7519badceb745b7d0da3197fec4d709f83580f82c2795b99ed3b1fe3eec0a4a1e644bb03fa8c7c8e77a196e620d294393e1fae4c59daf4dda95808cba1abeb0b44da08eee3bcf13ada6d53bdd8ff1d7c2d2d7c0d843a3618ad53f5dbe3fe47246e97e805eb0b3af54c32592b7805fdcf450044fa05926cde96176a34f12494cc2e0ced6e28d94be0dd9a377219b8061e80edf14d0eac9491a29e4fa25933ecf372a862ceb07cbcc1faac1a8c30760571c5b69fa51be6a1f591d5d7a37afca271b2a868cecbbbf1d64d942def1d6dc292aa472afb3526040e6278970d7e49cc3dd75eaf35dfac04a2d81a0c5397703864d70628b33ead1efbfb2678ebbed57c860f107cc1c7ae8dd6f261d6b1ec91322106fce8e6d088500b224eeabee329080f06c3577c5e934ac6704b8d049ab4b507cc064a49d28a855ed3db5ddb792cd504d9b294aaae1e1e0b3111298c200f5e3ea945b37c2d2d7c9049996f9e0e8e3cb8eccc4075b9ae0629156cead0f8c1944c67d6e62638dcfdc016958533f4e84df7f59061867d94556dad695398bca352137d23b30bb20ec127894448a53758242874a8eaa322ffd2cf190cfc4eb73b4f55b1893576e184e9652ee0f3e0ac7da9c110c7a9a3372712e35a8b37e7695a85f3323ad1ed62dfd32a6619586cdcaee4113159ed5a44b2da30cfdea01eb8965b76397a2bd891ebe8c2759bcd25c735d2563d2b0c686345660c42987b65ba98b5dacf09a407c60569b8cd6929f012a934189a73d532f768032a8c336dcf235b130be429adb24adbad0ec27866b1f9ce87aeb4b26b95e9f2e44c8aff9ab5e3e357d3b227edd1702a4d7c2d2d7c61651c320abb0922cc7a45e7675b3c214dac2d677bdd16c68c4be438d5de905a6fadae17988f8fa4af285a67a0c1c52f4d3e9e0ba97bf8d3bdfa842f708fe44c2184d82d8cbd7e84f80ccf9a9180b2a72422115c736f887918679fecb60744d28f580e3c3288683cbb0433350f45692ca89300be033c1f71f4bff566e1be301b79495156de4d482bc0a603595f2599e3336c7a1c8f9f7e76661b0fa93a0263f32699a0fb535aa0a03dbd5e103c0e2ad6c81294559a11dc392a4903acf69327450bd9834012340d2793307e869a0067099dc60dd3c4e00bad0395fbfda5ba0fdd71e7c0faf3d992a0fdd14c97a16f69d806507488684a96c53bd3fed8cd554d1a7c2d2d7c6a1c3ea83b366499cad909dc828694ddad4fa1f60beae98c34e8aec54d8f3e34c1d45f08e7b008c8157651d4536379498eed4b8d40983e3bff403c81753d8079b960ffaf107af96d93e7834cbf00b1ace3adfbc986ac324d378d266f0e5e047435e2872b53767fd1f7aa69d1d0f92d6e066fb3ab8bf856b3cf30d6d05bc4ef40bd11da9f63cbb2e76ae13cd1d145acbe681f23f30dba08ad43651df2b9e22a35dd8bd3feded2477f97d76808fd1df99de7fd0be059bbf95abef4e0d4227d3d7cf5e87cab5acb09ff07c0210c62496a08766f188708bdff14af02955735d565b65eff60386830247985b03fc9bd9fe6e5617a052804895c4e83ee8efe7f5a3f547c2d2d7ca6bf809613364c17d0b270bc29023f520b8567ba50cd834244e9598e06e95d18577d94ee9e234c61f0b178b71c33276486801f0555087c5d54e9a175bd847ce49e913c2029b95e6aff11977d4147a7c2b788ae4c05512d3520fbdba2db621e8cf98ad905f74f0cba96486b400a76ee508ab628ab4830dc26e1463d935c933d9d027263db1099771ea78f7c224676024e75c34c6724dd871763ac40ca78575ee487fd93c1df1522d28ec271365a29cde163269c9d7a534a619a69f59b1d62c8f8a484baceb8c49f181d7513e3b54433fe0d541478943831b81e221be076bc8debe83da2833ac522fdc8a5e72b2280243d972aac4252ebc3ce2a864803cd8acdde
