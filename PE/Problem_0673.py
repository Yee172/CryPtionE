# At Euler University, each of the n students (numbered
# from 1 to n) occupies a bed in the dormitory and uses
# a desk in the classroom.
# Some of the beds are in private rooms which a student
# occupies alone, while the others are in double rooms
# occupied by two students as roommates. Similarly, each
# desk is either a single desk for the sole use of one
# student, or a twin desk at which two students sit
# together as desk partners.
# We represent the bed and desk sharing arrangements each
# by a list of pairs of student numbers. For example,
#    with n = 4, if (2, 3) represents the bed pairing and
#    (1, 3) (2, 4) the desk pairing, then students 2 and 3
#    are roommates while 1 and 4 have single rooms, and
#    students 1 and 3 are desk partners, as are students 2 and 4.
# The new chancellor of the university decides to change
# the organisation of beds and desks:
# he will choose a permutation \sigma of the numbers 1, 2, ..., n
# and each student k will be given both the bed and the
# desk formerly occupied by student number \sigma(k).
# The students agree to this change, under the conditions that:
#    1. Any two students currently sharing a room will still be roommates.
#    2. Any two students currently sharing a desk will still be desk partners.
# The downloadable text files beds.txt and desks.txt
# contain pairings for n = 500. Each pairing is written
# on its own line, with the student numbers of the two
# roommates (or desk partners) separated with a comma.
# With these pairings, find the number of permutations
# that satisfy the students' conditions.
# Give your answer modulo 999999937.
# ----------------------------------------------------
# Analysis: disjoint set union

689ea6c8888326068c6bf7c97e2cd56fd7d8cb0b62ffa5b38b93d8a0447d57b1086eeec3f72d975ad9aa0b2a7feb7b18fc33
98e85dadb72b8851da34f34e09c1525c5dbb11869c0138286c8335cd867fae36eda342ee9b5ae0b91bb67ef58d688f67c46c
63601d5bab8a7071f58174f369e7751abb589f87a01f2aef70054306f9b0dcd7b9f3c62479b472cee8a73e2b77bef7eb7524
56be4083ed7bbf9c0f753f7ad59e7e05371e2722b24ec412523d662a6ee868fa55f053679736b61dff54ca65a18e7c1752aa
0f9e5f170f8973eef481e47a96773d00eb99ea0c83f03076850cf21b40de4f7de3e768cd710d301292b2338c13ea7a84e61b
6f7ddd6f0eb97c2d2d7c1a6030bfba1a89394d4b87fe08cfba40c1076964d5bffead9f307154b9dda546cbf3b6644acb2ffb
f99f5f72a51570b0e1291b32fa59644a2576d3dd833c67582826401b9303959b7e458aeb61610d169b34776ba4c4c7431bbf
6c47a93eeee284514eb566c718132898efdcdf45dbf9ee701e36caf1cde787ba79d8d670ab3407ec994177170b67ab29a102
294f06a7b1d33dc237d3deb133569bb5fb922a150118dad0958ec1481356d797069cb6cb86e8117d937c441eda53794965fd
bea5e2c2d67a0ad68fa5d2d5f0bb93c38bca17355f484de12243fe42e2d7bb657cdda1852126838e87aaba03a79e355c0098
ab3ca4b4318c3dd498b0629219d7dfcf7c2d2d7c7f984dcd100f682fffe0e179edf3ea4c5271ad197ad3dffd4b2049ed12ca
9f6fc3a1c68601ed9a37c71665b9b7e918430c40b5ff87e107f5a5f96384526e9ba89c7c384225e7a9b01e11c0258ebf0639
493baf6b9b4ac7e7888fcd87f86d18f78ec3fbb40fa2b3bde8de51995655198a0b14359b26d88d6e4464d5e525e63c6a83a3
9a1e3366879d5ff63c98b767ca763b01f68b3006e0bf8fc161fd0bd0e4e5f2ad702cd9a43f2a5637bc6ccdf675b0e87670e3
ee2b0c88bad03dbc4eb01e4e2ed3138661ca3a156c15259487478b18daeaf372d4dde42075d150cc690e174265d549878993
84f1c8fa88ce83a6425bb77216fda21040e830d7279b3efbed2c7c2d2d7cbd374cc55d36f7831e53c025e91d17551aa71497
389cb23d3b835881c0bc2df62d2ce15d193847ae62633c44ddf1052eeb0c88b56d98c7bc14f059d2e9d7b8e440e1edc17948
9dca420e8ed5683c2daaaa364b49a296b416b0dd6f02f3a10fa2fa693ff5020a3dd971bf477c7249c1a499bb5bedad073bf7
07656bcf2762d64acc21c7c3c000d2a038d25ca73e39d6871833f1ca1e13e8dc8f71a1a351277a53809251f8c7c293505462
3f1f4655342ff1e7cdf5d9ad3f47fcecfa8fe95302f3c733258d67449a8b6a30730b36c95e77bea8c618341fa2abf2180c54
2ac987cbd66950c29e4b7f864db2f9a76c7ade11cd14d2e53c8c292d64da4958fc4d9dfb7c2d2d7c01f28c40227d5012d2ff
1cbd3b94b1aefa1a4289e559b394bd9035739875c6d87553a609982f399debb9009e952059d72211aff172ee12addda43750
9adc4bf9a1f964161d819edadfc64ad47e5d7fe30b1cbeb241416e1cb7937d0bee0872f79fc2f93adcf9688b1fc47a400fa2
0f20e116b290fa4d8b7456a7ed9732ea1ecf87681c574b14924287090fd6e65638a482049dc7f3b8bf26086c63b92cd1f93b
c4f77b86a5c2a867b422318fa911ca1ee5d8bba49415c318dfc0e6d773e05d7b1eb9933bbd5749c369e8458eebee04d757e5
99f728530f4a4a44ee39bc5caf59777b476e2ecc35667b158e459d9cee9a61995d19d4c0ab5890756e12f52800637c2d2d7c
2cbcae4d706a19c108b89e7ebb13b3375864589fbb0151ceb09d48e0aa8ff71554afddd67fea15ed131cab49300025abd7d9
7e6d72fc9ad8d7ffb889e86a7de9e79885e7ed9023dd0025b7ff503e291fef0ed9b69bf33eb2988c2d100d3efe515085d877
6040c90728d02e0aff719976688afa0ad9d216150405fb4743db37c28346569dd0f2ee04855f7adb870b42fb36b5852d354e
a767ccfa1926b259c6384c75874c115f8e24ac7700d9184de294848d597488a88e39e342b48d067abd5ce547201ca60343ee
4ca822a2ae16b298c71e7daf1e560ec062be229017fbc125b8b56e65858770e9975f9bb7aa7eb79a269f76c9416ffbf180e8
245f6eeae0127c2d2d7c55c369358f7ca1933b2d19d4c4c8828176afce4a842fc38d61adbb548d5b2cce9aed78b30903ba64
05e86ce108fedf397d445bb0a85b57008a8d43c53d3887c9098c8ba8f9acb4edde32efea841c69c2ef670a7249ea6af05ee0
0cced0a89d26ab78453bf2e5740d55f08eb0fdc5562f82dcf24747ceae8457c816695815b779a98ef0773288b2ead8f822a5
90ac6f61f5d51096de81e21f058d4593b2f89d236d03895cfcfe006ae1b28a28f99a0c215ac65f2e02646448126fb56b146d
bef85a3cc7911ba667f061b687ea51dfdac0ab14fe742e5c0e33227874b2b6db56ec31c7ffdc15df2989e56b92c309c61c8c
5fd944800d1d6d08836ffdaf20ff85ab7c2d2d7c54d965f553e366b6e7c5ac227dcc83b98813a6eeb755d61f483765e048f6
45ccc75a72c7234724775fca1c39b8fb967604fa374d42985690bb419723f44b5a6506d92d2959793cd5ffbe1be1a535134f
2b00a8a8bc4e5b1e2fbe201c93262300177c4c540899ab7e34f2a71be959a14c200c1c2bf558ae2108b50e89f5545f489e94
3b6d4c277b79c088faa61944a9252ed1837be86c30e70c90d4a48ea22596d9d21a5a78db8315e25b9e71e62c29873063905d
c0a008766d4a067465019fd541be1253a9b9701b509fb9fe372004ba9ba0a0c4494c4f3d4c63b5895a330e15cc9d0712e701
e4549b6c5d804b919f6271ee74ac7eeda97667a0b09eeda836b1
