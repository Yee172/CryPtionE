# At Euler University, each of the n students (numbered
# from 1 to n) occupies a bed in the dormitory and uses
# a desk in the classroom.
# Some of the beds are in private rooms which a student
# occupies alone, while the others are in double rooms
# occupied by two students as roommates. Similarly, each
# desk is either a single desk for the sole use of one
# student, or a twin desk at which two students sit
# together as desk partners.
# We represent the bed and desk sharing arrangements each
# by a list of pairs of student numbers. For example,
#    with n = 4, if (2, 3) represents the bed pairing and
#    (1, 3) (2, 4) the desk pairing, then students 2 and 3
#    are roommates while 1 and 4 have single rooms, and
#    students 1 and 3 are desk partners, as are students 2 and 4.
# The new chancellor of the university decides to change
# the organisation of beds and desks:
# he will choose a permutation \sigma of the numbers 1, 2, ..., n
# and each student k will be given both the bed and the
# desk formerly occupied by student number \sigma(k).
# The students agree to this change, under the conditions that:
#    1. Any two students currently sharing a room will still be roommates.
#    2. Any two students currently sharing a desk will still be desk partners.
# The downloadable text files beds.txt and desks.txt
# contain pairings for n = 500. Each pairing is written
# on its own line, with the student numbers of the two
# roommates (or desk partners) separated with a comma.
# With these pairings, find the number of permutations
# that satisfy the students' conditions.
# Give your answer modulo 999999937.
# ----------------------------------------------------
# Analysis: disjoint set union

6a98a000817265b3e3ff3bf22fee29e6e7f2d5a93eb0b0eb337fd0af0b74552257f67dd0c76ed1e661e5bd74efd7943fd672
a15bd3d4a5c01c3f6bdb3957cc590e932424bb70b3e5e55c3c0796e71c263695eca1e4e9d938ddeed873a97a559bef4f790d
48a73825c8547809272046ae79880a379f3d43755fa0958202c65cf474af727bf13d16f32dd3854f9009f5da04022073f195
5252d6e0ce99811ecc14bc006346ad178d930034180ddd84ea36dbdebd7481c37a720284efb25e855ecea4d9b303034b3e8d
d412f5554881a289608b36c0accb24b45ad7c4a00602cf4c2f200155be829c2288b98ddf3c107ca9ca736a05d14def9a4f19
082747402f9c7c2d2d7c81bc0fdf607165d0386cd4a803bb5db9438695d25e11cb2fdac3b86b3d76572a5bf23dad5fe858a7
dbe071b7beddf70c9a159aab9f6be27d51ac6942c67a93eab120e5a5820c8fee78f8e920668864632f10d34333e6c8816683
19bbcad18b206cb087d0e0be04b8bced84fdc24521ba9bf4c46e4af1933e4f840a2a44e3004724de46f28f898acec90f2475
4a25b1a20e824a6540d5a0c3c0d2b208b5e1ac4a407769df340bded58836c3dd7347fa604c8153ecd693bfe084e3cd97ef1b
70d207ef8b2ca608580d3c5ca238920a38bdb534227819458716e2739ee427d76b887fe8962840720a399eb1dc5c30262c09
1b1fe68b2892606b9e5d18b4d81844887c2d2d7cc59c1a0f8c2f52fc1b3892eb6caa28ff75fc187208af70ae055072414144
7de48597d29fd3ad6b459b4d39cf19423d0b4f0aaf36f406d4798514f7fbd974b35b6fa840dc11b27faafe0e734a3b752157
1cbf1e562cc65f39758831e6f60b3497bf1be230c4721b7d651fc45637edeef8f747ab66468372290993dd76e863db3ffec0
98b31f36a007ed6ba99c68c530420a9718d12da246cc70c08aa8c000ec21ae1afeac851a47327abf8fb8dc99c7f85a13a6dd
0cf87f025c9f27e2b48861c1d1c29d1da34747b23de1c1a6b379b71349ff6fb910cf0140b82a607846824e25bb70fcdf27c0
1d68c69f7ffc30afc1a1663e0ec35a6987b90725f9b9302678607c2d2d7c502b9c3aab0562f1c8f9d364c3bf8ae5c755d5ed
281c01085ffe0858681f1f079035a589ad1fff024309c1ca76cc6e8542a98740d63ee11ad12ceb54c12db6fd26312d4f5e00
31cb32d06ba9704d736cf7b39ca54deab5ad34b2e532db52c5065d14a1287663992e824ce0bfb5d1fd2b39f157db46ef13be
5b6011f99277d49523cbf79aba868c7d10a1aed0eb5f60de744e3a1305d17bf0ad24d76be42fe5ddfd8470e6ad72fa3c557c
d34eda2c226c6a2a2e7146ad03941d38a6c6b007c60bbbbf94c673bc8711ce88b2d2e38c684abf65b987fbc143b7976a9142
8f225a7cb2cb2761373d081b8de099cc026e6c35c67e7a9fa2198d6f6e2ad231c519788e7c2d2d7cc417333d4b2560a37c26
3a3e1732307fd9f4eba5c4b4bb2b243f14c3f7e8c2273dc9f60f641ceba6b859e4965e833e4ec37a8996f7356d636ef182fc
904a267b47ef8cf77090acf6ecfc37884a0d5e43a79328729965c1f22b902b307fadd222dfcf423a38011521e5009b36c60b
a35abf4f5d891fdf9f62197626c47f29e442d85822ca1bf9c5640eb9b0d72fdcc1c74cafd022f8f9247a59e78b51963a00d5
63b70cf168f38bb9a57917aaf08929d28cbc75b23cabfcdbf61e7371cd25a9296403061ed526e86667b8b53e4d8b226615f0
9c76a2fe1821de3d76bc70248ded7c830e36229fcf91bd382f18b778772ce597775940548d06abd68d85be6c41c97c2d2d7c
b9c9b6280665defadd155910b9d0a8465978e9f0abd8212f838aaa8836b36ad3b4b27de5d12561f38864b2a19af372c7d75f
732a9fedc4c7011f813d561a6fc335b2cd35eac4997cb37646a6d61a16c020071ff4208a210c642999428f9bad6e00a6a452
7899cd74819d78d3c5331e0e781ffbcb6028fffea34e7d9b4644d49b19d9f4f5bc2ff143c4ee8db0c367b0ca07096b3e0eb6
c0f03a5a354079ac800c8f935b8d1a22c0d08962c519246169be9124e3c18adae0dcf48c33a4447ce57fc0d527052ce36a89
083253d22fb05338645a48b5676c4b233a7ddeabf053fd8740c998f8b13f94e3ef26625463e99a52602e637d0f924d83a3a2
c92253ea320e7c2d2d7c96264f0dd93f1d66e6111b526d393dc07d5e3cacd8de1dec1d2dad9b24b68b178d82a89091e9429e
7f30ad0ba5c30735e0be9e016398b60b631b285d85af2158c659ee89da3c789b2598909ca040c2925e8563cff5fad2473bbe
82480c07dcac40bae77f1d122f12b53839c3fb7fb532bbf1b5de78b6a9976f29a7be0e5fdb7745f76542e3e6191bff67f00b
776f217c374f50005adb428d646b7039ce1a9168317e6d8b1ed5f58de5edd1c09a201706189eb07701b73911ff7e58d30eef
f7d0fbfa3c6548b1ce23bff0d3f4f719ff9df13969981ec592e85d2241ab84cdf88dc8b3a705b5c35aa6e656b9b0f22851a7
5bfaac43e4b2ad0be075e31848abdd377c2d2d7c94ad3753082dce24c677de8bb714ab79269725fe7d97ad9108b636624531
f98df2c3a1aa4c45a83eceb60d4b1dc39535b64dcb2ed17046fc1dac6f8492ec21ac5dac0a91b4d9bd9c67b11adcec5fab6f
32867e4beffb5843e9681aa6f51bda3f6f01d8385c49042bf80a04fa4b3e35acc434144f09df06dd8c2be12670552ccbe984
242803cf4e9b1aa3f79f46d88eb509d44f2c0700e25cf8db7d0f64aeb4f3980b5e114b4af3b687ff9384f8a105fc6821a0b4
78f060e37ad96485ed874dfd04fb6d5a975a071f08f56a13f897e9866bf39753cf847566c581328408c7625dc1c2d904bfa3
7b4bc464dd9721cb33ea88ee65e8268780b1bbf8760bb43d5aec
