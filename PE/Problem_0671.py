# A certain type of flexible tile comes in three different
# sizes - 1 × 1, 1 × 2, and 1 × 3 - and in k different
# colours. There is an unlimited number of tiles available
# in each combination of size and colour.
# These are used to tile a closed loop of width 2 and
# length (circumference) n, where n is a positive integer,
# subject to the following conditions:
#    The loop must be fully covered by non-overlapping tiles.
#    It is not permitted for four tiles to have their corners meeting at a single point.
#    Adjacent tiles must be of different colours.
# Let F_{k}(n) be the number of ways the 2 × n loop can
# be tiled subject to these rules when k colours are
# available. (Not all k colours have to be used.) Where
# reflecting horizontally or vertically would give a
# different tiling, these tilings are to be counted separately.
# Find F_{10}(10004003002001) mod 1000004321.
# ----------------------------------------------------
# Analysis: matrix multiplication
#           Hint: loop means that start state equals to its end state

a4748dde36f935b3469403c12a71095e92cfb23502324cbb397181a7eed7baa04436efcefa93a88a477026c9aae438098ba5
5406535337bf539aa587dad6a6e86eb82549a482325f572fc8c0e52a272d2d978cfeebaea54721a433c10e56f596ed467bb5
b171c69725daa10d16ef6ea21bb60542c3ed6ba372439d96c04319c50469813343ac17cabedc30752242dd27c542cfca718a
bcdb8293284e2c3ec384f6610a0a66c92b0f165649d37baeaa45a4c4c9d8db1e526d0a59f3ef0529e2283c6223a5cb7d580e
37f5680bca0e318ef651dec72d453356f940d68140223ec695cacde19ee9787ee8f70f45d8f217481e79cdb34e48fb8f4491
32c16927e1897c2d2d7c4aee77d5086f03c6f521d21467715adce00e3220a7a06b38833fcd7299afa8599141e25001508b43
8befd2567c2ff5328d9673680785c1b3d452031511ce4cd22f79745f9bd71d3c8ac58399fa673564f3fd06d19e961041f138
f7cbdae53445fae7711cd919ccc0b03d5300eef094ea4e48d630524f713f051a4d52d55d1d34e7272bcc95f5b0fcb8dbd88b
89cf8ad1ec38f2176a09071476139a31af44a9301d5eab54cde6278ff76df79eeb7b1170ddeb269722888240df783eee8972
300e8baf107ed9bcb45a0bdcaddfa66cbb137535834dfc116fbf247b7b56ffcbdfe534b342fb446ea2dddf6b3ca24c3ef75c
b7379864d0f63e687f5cc65f328f8ae77c2d2d7cb2dadc0960b4b0143d3e99e622866a87d91fedae082fc233fd42cebac189
c5a1a269f0c15658f5eda13b49df11a830fce7bff3a794a677598c545dfe3b3ab12e5e24ad52e5d1debfb032977322c1d12e
572669d903b7764be9ad591832b8a39a4320858e4614aeeaa315c4bb0473dc3a36d760303ef7e2bfe4f084b565884284308d
93a66b47ac33609f96b344139f5ee83dceb1a970a9a4700c440d0cd51df96f6939ad616edc85464cd088565fe572e0c93fa0
5b4888621a3b9bc7370a494fd41e9def2e4a76609122222ee3f6e7cb8030de896a0ccf3931bb93cc57f302840364104b85bb
95fe2143740e4bfde5c7cf641f3415adb00b9265ec79e2125ab27c2d2d7c65b8f6d44f124b1653a3958a1cf7172051ddfbd5
a671464184a5509974ca61163408bbb9c9679d0e74f9cb895f2f95c1bd784c7679860ab17c9c33c9253be09be8a2a5a9a863
7f4fd876cc775e96e465a527f88234eaf00d0fb95ade6f59349ab8e2203d06e6ef9956d8d37c5c189278813c60ab22f68381
da1d62f7f6b8575a5f41e6e7d27c3205ab0d21dc5ae4a8c4b862b5e2a68304ec5fb567cd97706017db333e03fdfecd5a7e47
93d3391ecfe47fc37109fdba9dbf473ae0428f8bc4afc7c7ef98ba471511a9e0a9fb89d3818bee872ce8d21abd39140ceac0
13386d4d1c22979aa4597d2514e57a0932fe6641eb3a05746a6e0af3e3a876c1a34b503f7c2d2d7c1c9e2a861f438f20c8db
34e83e8d8e819b6ef6e2009da8552c5f390b7a22cf1285ef41cb7c7c020602c9d4d0f223226af6126203a382b21840cfcf8c
e8f50c5070d9eac13ed92fa582bd663a16232919a5125276c4103bd77bd12d327e82621279384b11864e9c82047157598b87
9841fa09dd26dc8e4cab4b980c69972d598a2ad946cd310b1903533b52b1b2763ec2d35a7c17a52e8104c3f6ad76240576e1
c9d5615b5807d30fdbf22c872245af1ad299c967f4c32f1f5c85cbbe02f88cfdd93decf54f958e7082221843fe0bf7fb9a3f
31e1934f784d55462c210ff22bbba2733a7f96f565b17e436f325a3dc295b5475db0d18807c867417323c629c0477c2d2d7c
1bf90b3fe1175f896cf125c09b1103f06335e4cbab5cd4317d04c3b0d1bd9346806fcaec340a1cb2d5a986de050f1e7f9362
9fabfcc0aeea641cb9a6c04e691241d25768f5145cd86b255961c26b9226b6dff3d6882158bb0e0c67388ba5d3aeda42d2b4
af7040171d870d409e8e6b743df5723cbf74da55b6d206825ffb7a16efa4acc6ffee3ad659a0ced62b88f0880936c2231c1f
72eea7f6abbcce6678b1ef980e2d5087055f1fefcd5ed6a0bec1860e14bb178c2d5f19f42d7fc696144b1e74aba47fd657a8
88adb29e3833807fe215cd5531369385d05f3ebdfcb9d4b1de67736b0f91b099d56196093a14624fc6e738e2f7b6cfbe9b47
2c8c106e6a357c2d2d7c4d7c2d730f1a616b6a3e8e29938fda7990e4fdd58526ce17f8701a39b26c1afbc538a6b4cafbf97b
b889ae8644a603bd9d7ac6d36c00ce7282f157f480e56185e3ad8fc053d8222aed77ade319847fb92cbdfbe47154e77f9904
ca7c1ccaa72a4aa0023780a77da0f863bfbdfe866832c386499d227bcf173114fbfe7dca18f29a4f4376f5c35cadcbff78be
c9c12c4ddf4c1848c4b9a8008ff4634e78e15a5a3ed42e327807e5eed66f09b292523413e6f59e53a55040272db7bf937f35
c04c2a38e15422ca367b5ee4a1d3d776207d24c66abb7434739810429ce5bc230344332abb7e3e87a2f1e90a2c525af84c68
55e68551920637e5e76310d70ccce49f7c2d2d7cc46d9cb18afa97442da7e8160f97d81b2fc1daf598f858486fa22db19401
7b311b682f2f990a4033d95087c03e63b68e46c84afc9d6d1c487c5d294a444ac0e59b8782c20528c9d4ab373a2b6b2f2f08
cd93c4ad75756625d8d08ac0847fcb0a79033ab8f615dc303f2b50c52fa255e1a99ff62bfd3041b00ce7cfbbbe84c56cc4f3
01d221d5ff786a0e598e54a5fcb57d00de9e8136ad66d8c58a23a21646db88b3bc1b8da75cc4992eb917f2d40842fd88fd4f
95e86cadd1b8a7c0dfbbe964108e7523b9498bab0b7587b92d2ae6cf38a424f6a55aad238ca987bd9874ed1a843bb876e2a9
cfae76078a9be1e2d738295e8dfa81ada1a4b5502dad551320637c2d2d7c92e4956bbaecef84050a9c32f279f4542696b2b4
d483107210819653c13fc4b1f7f9f89647e11455185acf0c4dc2eff8d4960fdfe52acde2c01a844fb0a8637842e19e0fd71b
36f2d3e54a6e62d8a6566fb0340b72f6bb0db13d95782dd6784c4a90913a53dcf5f313ec0c326a98e22228981abef8d919a1
402115ae457f72d83ec68d304975d8068c2370771c579964cccea1ae0f5c123fe691eed9f0f1151ad04eaad34a632033f231
effc8ca96b01c0d13740bf06c88354fbe6036fdb57a5eeb6bef14a2b024cbd6123165ff21461ef84176f8f065b990d256ead
f0929acb9388385339c38bc6bf6062480c3f2b33c3520ed6e51381be65cfaa66f61dbc787c2d2d7cbc7c59899e867098aad5
5558a0c8256474de9d28b3567fefc9d50557ae22588305443368269c3a8d8d1b166275c22f7a9498592fb0e636e1db0b030c
eafb48b8820e0afc28d8ca30c0f50f7f3bfe8baa9360137804079be5aa6ae296222b098b5f29b9d7df35c0db75e5551711ca
7e1852ce0e9ac3b67c6cfea217ae40ea41a2084df30e6b32dee1ac84081f5ac51f6a0d32aeea0bd58e274e713edb0ac6adb2
376942ebb9dbb4b5ad9031db3f3f952150e067ae9e50b62b7f8c0a4b0c216136049e564e678ba6b8f0d7d1eb52c85aecd71e
bb058cf5164f70ab7e64b2117a301049658d8b535452914712a72f15b39fe7c13a9841614c07e7c41f2af5aa55d27c2d2d7c
6a02f1976bcfd9ac1b925b561fb169bc3eded8e9c54cae0b9df795683cd82425395007905a021c7f662a9aa8c190ab17c8eb
c7d67421948c2d8efc40d8363ba0681fb89f756b2a5ca36754ddb93cc5a4873fdff0e8d49986eae7b3e513e64de0a5c9afa3
daf096429afe3964af04c7cdab3a570d218fa35da3680b8738056cbe112646a52e4a5887972bfcad8c31d41fbd1f93274437
322e436e3b0479d7f7c7a27364250f31d531f1c32bcec381b9c0571d163c7b59f20ad7b65c69f1b0032cf9da1cbd91cad800
691660ced68f0c3988572f84df833c8a1fb0039e7e55bbe7d58df913f5c25639e0ab9e5f0fe84b49b8c2d4dad56bfd161822
d61d49411c3b7c2d2d7c424bbf8f7744692926caa714e86c4cb64196c6a7f426545f69d3e6a37a9de0f791717104c2e5693d
5ec2cedf39a85b1a78529c3dd9cfec3447721f17301af0e60ba53f1f4dcf7cc3020a6b9d322e3eb41427321128f17ec7747f
05fb7c5d4558bed979db547f29e9694f9939860bc04d5b2d46aa9fba109f61226b1a2e214f7e046356af4189ed3a3172bead
d974cb092a7de617bee9e8e93cf27643cd38a2dcbc3559531d22d2698652242e9e1593bfb1cf16d18a5440d6b19f68411c24
e45044ebb0e5592a2daed0f9346f691ab0a7f789c70a8e9b9c281902d7dff1447f5ed25038e6b29f94a069c83d015e3f2ae8
8e0e3ccffe4974590b2c6cee53f130d57c2d2d7c6dc3c3b8189769c8a220cb74b222d21dece0a0734b71d6902b9d941087cd
dbf2bed3394386a6606727a698fc80b2068128934aa8a6fb71c3db165c7c4141bb963f117f91970bc9ba0ebe3c921297d48e
6ca2e20ff265d843cad058c1c5dc6c9a37b1fb2f87c469367efe00671cacce7c89239e27ac012fa9990083181b3d0b58ffd9
b2fd9f60c51fb466fb4c565f6239069ad92c0f83b53cb619852dac0e2e61dff3a8be06962d6437c69274617e110501809667
1c0d99afcf730f7fc2c3e64263556eb83448fbe35f096fc90e197a2fd461fe46232a5bcb8ba0f1a0ac5347eb82cc90771d55
fcfcbfcaf4032dbd2061d9b177f73abb66e7ec62e372eeb7cbfd7c2d2d7c0ff437edefc59caf8990afb0c78942ed5291d90d
cd92890975f85d29c35329ec1c3ae93c279f9b64406f5ba22e2d15c9e19f7cd9bfc91be0958dffc9f01ffcfd97b9f067b476
a53f4c3bda938879df17aa6379d997386f36dfb4c0b901313ce1cc3f964711b53e7be858d0a1b66827275c0ee3073318d7dd
819ab2d07f6c36594dd35c91304eeb1c90c566e83b0b5bb5e469c284923029905fcdbca7360d5e73fd096ded289032675dbb
1985ee284ae034f49aa0fc83d3f3ffb14a7cd646e46ac715d17857f492bb8867aa8a1d15f48a799dea5ae72e84428c7e520c
c254c121ef4b704f536efda088f1e2aab884081aae32b1c1b746f29abec6d39c90ecb2f6
